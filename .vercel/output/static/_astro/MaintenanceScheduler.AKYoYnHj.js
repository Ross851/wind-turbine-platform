import{j as e}from"./jsx-runtime.BftctW7E.js";import{r as m}from"./index.DJO9vBfz.js";import{g as D,a as S}from"./turbine-service.CN_jfETl.js";import{t as g,c as k,s as v,a as M,f as h}from"./format.DnvyW2U9.js";function p(n,d){const a=g(n);return isNaN(d)?k(n,NaN):(d&&a.setDate(a.getDate()+d),a)}function O(n,d){const a=v(n),r=v(d);return+a==+r}function T(n,d){const a=g(n.start),r=g(n.end);let c=+a>+r;const x=c?+a:+r,i=c?r:a;i.setHours(0,0,0,0);let u=1;const o=[];for(;+i<=x;)o.push(g(i)),i.setDate(i.getDate()+u),i.setHours(0,0,0,0);return c?o.reverse():o}function R(n,d){const a=d?.weekStartsOn,r=g(n),c=r.getDay(),x=(c<a?-7:0)+6-(c-a);return r.setDate(r.getDate()+x),r.setHours(23,59,59,999),r}const W=()=>{const[n,d]=m.useState([]),[a,r]=m.useState([]),[c,x]=m.useState(new Date),[i,u]=m.useState("calendar");m.useEffect(()=>{(async()=>{const[s,l]=await Promise.all([D(),S()]);d(s),r(l)})()},[]);const o=M(c,{weekStartsOn:1}),j=R(c,{weekStartsOn:1}),y=T({start:o,end:j}),b=t=>n.filter(s=>O(new Date(s.maintenance.nextScheduled),t)),N=t=>{const s=t.maintenance.hoursRunning;return s>2e3?"major":s>1e3?"minor":"inspection"},f=t=>{switch(t){case"major":return"bg-red-100 text-red-800 border-red-200";case"minor":return"bg-orange-100 text-orange-800 border-orange-200";case"inspection":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>x(p(c,-7)),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("h2",{className:"text-xl font-semibold",children:["Week of ",h(o,"MMM d, yyyy")]}),e.jsx("button",{onClick:()=>x(p(c,7)),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>u("calendar"),className:`px-4 py-2 rounded ${i==="calendar"?"bg-primary-600 text-white":"bg-gray-100"}`,children:"Calendar View"}),e.jsx("button",{onClick:()=>u("list"),className:`px-4 py-2 rounded ${i==="list"?"bg-primary-600 text-white":"bg-gray-100"}`,children:"List View"})]})]})}),i==="calendar"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 gap-px bg-gray-200",children:y.map(t=>e.jsxs("div",{className:"bg-gray-50 px-4 py-2 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:h(t,"EEE")}),e.jsx("div",{className:"text-lg font-semibold",children:h(t,"d")})]},t.toISOString()))}),e.jsx("div",{className:"grid grid-cols-7 gap-px bg-gray-200",children:y.map(t=>{const s=b(t);return e.jsx("div",{className:"bg-white p-4 min-h-[200px]",children:e.jsxs("div",{className:"space-y-2",children:[s.map(l=>{const w=N(l);return e.jsxs("div",{className:`p-2 rounded border text-xs ${f(w)}`,children:[e.jsx("div",{className:"font-semibold",children:l.name}),e.jsxs("div",{className:"capitalize",children:[w," maintenance"]}),e.jsxs("div",{className:"mt-1",children:[l.maintenance.hoursRunning," hrs"]})]},l.id)}),s.length===0&&e.jsx("div",{className:"text-gray-400 text-sm text-center py-8",children:"No maintenance"})]})},t.toISOString())})})]}),i==="list"&&e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Upcoming Maintenance"}),e.jsx("div",{className:"space-y-4",children:n.sort((t,s)=>new Date(t.maintenance.nextScheduled).getTime()-new Date(s.maintenance.nextScheduled).getTime()).map(t=>{const s=N(t),l=Math.ceil((new Date(t.maintenance.nextScheduled).getTime()-Date.now())/(1e3*60*60*24));return e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.specifications.model}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("p",{children:["Type: ",e.jsx("span",{className:`px-2 py-1 rounded text-xs ${f(s)}`,children:s})]}),e.jsxs("p",{children:["Last Inspection: ",h(new Date(t.maintenance.lastInspection),"MMM d, yyyy")]}),e.jsxs("p",{children:["Running Hours: ",t.maintenance.hoursRunning]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold",children:h(new Date(t.maintenance.nextScheduled),"MMM d")}),e.jsx("p",{className:"text-sm text-gray-600",children:l===0?"Today":`In ${l} days`}),e.jsx("button",{className:"mt-2 text-sm text-primary-600 hover:text-primary-700",children:"Schedule Team â†’"})]})]})},t.id)})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"This Week"}),e.jsx("p",{className:"text-3xl font-bold",children:n.filter(t=>{const s=new Date(t.maintenance.nextScheduled);return s>=o&&s<=j}).length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:n.filter(t=>new Date(t.maintenance.nextScheduled)<new Date).length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Next 30 Days"}),e.jsx("p",{className:"text-3xl font-bold",children:n.filter(t=>{const s=new Date(t.maintenance.nextScheduled);return s>new Date&&s<=p(new Date,30)}).length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Hours/Turbine"}),e.jsx("p",{className:"text-3xl font-bold",children:Math.round(n.reduce((t,s)=>t+s.maintenance.hoursRunning,0)/n.length)})]})]})]})};export{W as default};
