import{j as e}from"./jsx-runtime.BftctW7E.js";import{r}from"./index.DJO9vBfz.js";import{g as M}from"./turbine-service.CN_jfETl.js";import{g as C}from"./weather-service.BbyU-1F5.js";const $=()=>{const[j,N]=r.useState([]),[g,b]=r.useState("all"),[f,v]=r.useState(new Map),[u,w]=r.useState(new Map),[m,y]=r.useState(!0);r.useEffect(()=>{const s=async()=>{const i=await M();N(i);const l=i.filter(n=>n.type==="offshore"),a=new Map;for(const n of l){const o=await C(n.location.lat,n.location.lng);a.set(n.id,o)}v(a),S(a)};s();const t=setInterval(s,3e5);return()=>clearInterval(t)},[]);const S=s=>{const t=new Map;s.forEach((i,l)=>{const a=[];for(let n=0;n<7;n++)for(let o=0;o<24;o+=6){const d=new Date;d.setDate(d.getDate()+n),d.setHours(o,0,0,0);const x=i.waveHeight+(Math.random()-.5)*2,h=10+Math.random()*15;let c;x<1.5&&h<15?c="optimal":x<2.5&&h<20?c="acceptable":x<3.5&&h<25?c="risky":c="dangerous",a.push({start:new Date(d),end:new Date(d.getTime()+6*60*60*1e3),conditions:c,waveHeight:Number(x.toFixed(1)),windSpeed:Number(h.toFixed(1))})}t.set(l,a)}),w(t)},p=()=>j.filter(s=>{switch(g){case"offshore":return s.type==="offshore";case"maintenance-needed":return s.status==="maintenance"||s.maintenance.alerts.length>0;case"offline":return s.status==="offline";default:return!0}}),W=s=>{switch(s){case"optimal":return"bg-green-500";case"acceptable":return"bg-yellow-500";case"risky":return"bg-orange-500";case"dangerous":return"bg-red-500";default:return"bg-gray-500"}},H=s=>s.waveHeight>3?{status:"dangerous",message:"No vessel operations"}:s.waveHeight>2?{status:"risky",message:"Limited operations only"}:s.waveHeight>1.5?{status:"acceptable",message:"Proceed with caution"}:{status:"optimal",message:"Safe for all operations"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Offshore Operations Monitor"}),e.jsx("p",{className:"text-gray-600",children:"Real-time sea conditions and maintenance windows"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>y(!m),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:m?"Show Turbine View":"Show Sea Conditions"})})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:["all","offshore","maintenance-needed","offline"].map(s=>e.jsxs("button",{onClick:()=>b(s),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g===s?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s==="all"&&"All Turbines",s==="offshore"&&"ðŸŒŠ Offshore Only",s==="maintenance-needed"&&"ðŸ”§ Needs Maintenance",s==="offline"&&"âš ï¸ Offline"]},s))})]}),m&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:p().filter(s=>s.type==="offshore").map(s=>{const t=f.get(s.id),i=u.get(s.id)||[],l=t?H(t):null;return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",e.jsx("span",{className:`font-medium ${s.status==="operational"?"text-green-600":s.status==="offline"?"text-red-600":"text-orange-600"}`,children:s.status})]})]}),l&&e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${l.status==="optimal"?"bg-green-100 text-green-800":l.status==="acceptable"?"bg-yellow-100 text-yellow-800":l.status==="risky"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:l.message})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Wave Height"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[t.waveHeight.toFixed(1)," m"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current Speed"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[t.currentSpeed.toFixed(2)," m/s"]})]}),e.jsxs("div",{className:"bg-teal-50 p-3 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Swell Height"}),e.jsxs("p",{className:"text-xl font-bold text-teal-600",children:[t.swellHeight.toFixed(1)," m"]})]}),e.jsxs("div",{className:"bg-teal-50 p-3 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Water Temp"}),e.jsxs("p",{className:"text-xl font-bold text-teal-600",children:[t.waterTemperature.toFixed(1),"Â°C"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Next 48h Maintenance Windows"}),e.jsx("div",{className:"grid grid-cols-8 gap-1",children:i.slice(0,8).map((a,n)=>e.jsx("div",{className:`h-8 rounded ${W(a.conditions)} opacity-80 relative group cursor-pointer`,title:`${a.start.toLocaleTimeString()} - Wave: ${a.waveHeight}m`,children:e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 whitespace-nowrap z-10",children:[a.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e.jsx("br",{}),"Wave: ",a.waveHeight,"m",e.jsx("br",{}),"Wind: ",a.windSpeed," m/s"]})},n))}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-600",children:[e.jsx("span",{children:"Now"}),e.jsx("span",{children:"+48 hours"})]})]})]}),s.status==="offline"&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800",children:"âš ï¸ Turbine Offline"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Waiting for sea conditions to improve for maintenance crew dispatch"})]})]},s.id)})}),!m&&e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Maintenance Priority Queue"}),e.jsx("div",{className:"space-y-4",children:p().filter(s=>s.status==="maintenance"||s.status==="offline"||s.maintenance.alerts.length>0).sort((s,t)=>s.status==="offline"&&t.status!=="offline"?-1:t.status==="offline"&&s.status!=="offline"?1:t.maintenance.alerts.length-s.maintenance.alerts.length).map(s=>{f.get(s.id);const t=u.get(s.id)?.find(i=>i.conditions==="optimal"||i.conditions==="acceptable");return e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:s.name}),s.status==="offline"&&e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:"OFFLINE"}),s.type==="offshore"&&e.jsx("span",{className:"text-blue-600",children:"ðŸŒŠ"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.maintenance.alerts.length>0?s.maintenance.alerts[0].message:"Scheduled maintenance required"}),t&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:["âœ“ Next safe window: ",t.start.toLocaleString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Priority"}),e.jsx("p",{className:`text-2xl font-bold ${s.status==="offline"?"text-red-600":"text-orange-600"}`,children:s.status==="offline"?"HIGH":"MED"})]})]})},s.id)})})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Sea Condition Legend"}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsx("span",{children:"Optimal (Wave < 1.5m)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),e.jsx("span",{children:"Acceptable (Wave < 2.5m)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsx("span",{children:"Risky (Wave < 3.5m)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsx("span",{children:"Dangerous (Wave > 3.5m)"})]})]})]})]})};export{$ as default};
